[+] Done Load Model
aux num:512, small_val_num:15654, val_num:15656
Robust_AMD_INT8(
  (vae): VAE_INT8(
    (encoder): Sequential(
      (0): my_8bit_linear(
        (ori_bnb_linear): Linear8bitLt(in_features=379, out_features=600, bias=True)
      )
      (1): ELU(alpha=1.0)
      (2): Dropout(p=0.1, inplace=False)
      (3): my_8bit_linear(
        (ori_bnb_linear): Linear8bitLt(in_features=600, out_features=600, bias=True)
      )
      (4): Tanh()
      (5): Dropout(p=0.1, inplace=False)
      (6): my_8bit_linear(
        (ori_bnb_linear): Linear8bitLt(in_features=600, out_features=160, bias=True)
      )
    )
    (decoder): Sequential(
      (0): my_8bit_linear(
        (ori_bnb_linear): Linear8bitLt(in_features=80, out_features=600, bias=True)
      )
      (1): Tanh()
      (2): Dropout(p=0.1, inplace=False)
      (3): my_8bit_linear(
        (ori_bnb_linear): Linear8bitLt(in_features=600, out_features=600, bias=True)
      )
      (4): ELU(alpha=1.0)
      (5): Dropout(p=0.1, inplace=False)
      (6): my_8bit_linear(
        (ori_bnb_linear): Linear8bitLt(in_features=600, out_features=379, bias=True)
      )
      (7): Softplus(beta=1, threshold=20)
      (8): Sigmoid()
    )
    (sigma_softplus): Softplus(beta=1, threshold=20)
  )
  (mlp): MLP_INT8(
    (mlp): Sequential(
      (0): my_8bit_linear(
        (ori_bnb_linear): Linear8bitLt(in_features=160, out_features=40, bias=True)
      )
      (1): Tanh()
      (2): Dropout(p=0.1, inplace=False)
      (3): my_8bit_linear(
        (ori_bnb_linear): Linear8bitLt(in_features=40, out_features=40, bias=True)
      )
      (4): ELU(alpha=1.0)
      (5): Dropout(p=0.1, inplace=False)
      (6): my_8bit_linear(
        (ori_bnb_linear): Linear8bitLt(in_features=40, out_features=40, bias=True)
      )
      (7): ELU(alpha=1.0)
      (8): Dropout(p=0.1, inplace=False)
      (9): my_8bit_linear(
        (ori_bnb_linear): Linear8bitLt(in_features=40, out_features=2, bias=True)
      )
      (10): Softplus(beta=1, threshold=20)
    )
  )
)
[+] Done Replace Model
========================Before Attack========================
========================Start  Attack========================
[+] epoch 0: loss -0.20361328125
[+] change vae.encoder.6@48@0@absmax, loss: -5.98828125
[+] Start eval on small val acc
[+] Accuarcy:0.3806055960137984; correct_num:5958.0, sample_num:15654.0
[+] Malware acc 0.5078574166347259, Benign acc:0.25335377539287085
[+] Flip 1 bit: {'vae.encoder.6@48@0@absmax'}
[+] epoch 1: loss -0.8095703125
[+] change vae.encoder.6@48@1@absmax, loss: -39.84375
[+] Start eval on small val acc
[+] Accuarcy:0.13715344320940334; correct_num:2147.0, sample_num:15654.0
[+] Malware acc 0.13466206720327073, Benign acc:0.13964481921553595
[+] Flip 2 bit: {'vae.encoder.6@48@1@absmax', 'vae.encoder.6@48@0@absmax'}
===========================End opt===========================
[+] Start eval on small val acc
[+] Accuarcy:0.13715344320940334; correct_num:2147.0, sample_num:15654.0
[+] Malware acc 0.13466206720327073, Benign acc:0.13964481921553595
[+] Flip 2 bit: {'vae.encoder.6@48@1@absmax', 'vae.encoder.6@48@0@absmax'}
